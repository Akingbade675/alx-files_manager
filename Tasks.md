{"payload":{"allShortcutsEnabled":false,"fileTree":{"":{"items":[{"name":"controllers","path":"controllers","contentType":"directory"},{"name":"middlewares","path":"middlewares","contentType":"directory"},{"name":"routes","path":"routes","contentType":"directory"},{"name":"tests","path":"tests","contentType":"directory"},{"name":"utils","path":"utils","contentType":"directory"},{"name":".eslintrc.js","path":".eslintrc.js","contentType":"file"},{"name":".gitignore","path":".gitignore","contentType":"file"},{"name":"AUTHORS","path":"AUTHORS","contentType":"file"},{"name":"LICENSE","path":"LICENSE","contentType":"file"},{"name":"README.md","path":"README.md","contentType":"file"},{"name":"Tasks.md","path":"Tasks.md","contentType":"file"},{"name":"babel.config.js","path":"babel.config.js","contentType":"file"},{"name":"image_upload.py","path":"image_upload.py","contentType":"file"},{"name":"package-lock.json","path":"package-lock.json","contentType":"file"},{"name":"package.json","path":"package.json","contentType":"file"},{"name":"server.js","path":"server.js","contentType":"file"},{"name":"worker.js","path":"worker.js","contentType":"file"}],"totalCount":17}},"fileTreeProcessingTime":2.350071,"foldersToFetch":[],"reducedMotionEnabled":null,"repo":{"id":621336455,"defaultBranch":"main","name":"alx-files_manager","ownerLogin":"St-Pardon","currentUserCanPush":false,"isFork":false,"isEmpty":false,"createdAt":"2023-03-30T13:11:25.000Z","ownerAvatar":"https://avatars.githubusercontent.com/u/53058358?v=4","public":true,"private":false,"isOrgOwned":false},"refInfo":{"name":"main","listCacheKey":"v0:1680181886.254475","canEdit":false,"refType":"branch","currentOid":"1bb547466ba6932cf6b4744b62bf999a001e84d0"},"path":"Tasks.md","currentUser":null,"blob":{"rawLines":null,"stylingDirectives":null,"csv":null,"csvError":null,"dependabotInfo":{"showConfigurationBanner":false,"configFilePath":null,"networkDependabotPath":"/St-Pardon/alx-files_manager/network/updates","dismissConfigurationNoticePath":"/settings/dismiss-notice/dependabot_configuration_notice","configurationNoticeDismissed":null,"repoAlertsPath":"/St-Pardon/alx-files_manager/security/dependabot","repoSecurityAndAnalysisPath":"/St-Pardon/alx-files_manager/settings/security_analysis","repoOwnerIsOrg":false,"currentUserCanAdminRepo":false},"displayName":"Tasks.md","displayUrl":"https://github.com/St-Pardon/alx-files_manager/blob/main/Tasks.md?raw=true","headerInfo":{"blobSize":"25.1 KB","deleteInfo":{"deletePath":null,"deleteTooltip":"You must be signed in to make or propose changes"},"editInfo":{"editTooltip":"You must be signed in to make or propose changes"},"ghDesktopPath":"https://desktop.github.com","gitLfsPath":null,"onBranch":true,"shortPath":"fe9f8c7","siteNavLoginPath":"/login?return_to=https%3A%2F%2Fgithub.com%2FSt-Pardon%2Falx-files_manager%2Fblob%2Fmain%2FTasks.md","isCSV":false,"isRichtext":true,"toc":[{"level":1,"text":"0x04. Files manager","anchor":"0x04-files-manager","htmlText":"0x04. Files manager"},{"level":2,"text":"Tasks","anchor":"tasks","htmlText":"Tasks"},{"level":3,"text":"0. Redis utils","anchor":"0-redis-utils","htmlText":"0. Redis utils"},{"level":3,"text":"1. MongoDB utils","anchor":"1-mongodb-utils","htmlText":"1. MongoDB utils"},{"level":3,"text":"2. First API","anchor":"2-first-api","htmlText":"2. First API"},{"level":3,"text":"3. Create a new user","anchor":"3-create-a-new-user","htmlText":"3. Create a new user"},{"level":3,"text":"4. Authenticate a user","anchor":"4-authenticate-a-user","htmlText":"4. Authenticate a user"},{"level":3,"text":"5. First file","anchor":"5-first-file","htmlText":"5. First file"},{"level":3,"text":"6. Get and list file","anchor":"6-get-and-list-file","htmlText":"6. Get and list file"},{"level":3,"text":"7. File publish/unpublish","anchor":"7-file-publishunpublish","htmlText":"7. File publish/unpublish"},{"level":3,"text":"8. File data","anchor":"8-file-data","htmlText":"8. File data"},{"level":3,"text":"9. Image Thumbnails","anchor":"9-image-thumbnails","htmlText":"9. Image Thumbnails"},{"level":3,"text":"10. Tests!","anchor":"10-tests","htmlText":"10. Tests!"},{"level":3,"text":"11. New user - welcome email","anchor":"11-new-user---welcome-email","htmlText":"11. New user - welcome email"}],"lineInfo":{"truncatedLoc":"519","truncatedSloc":"416"},"mode":"file"},"image":false,"isCodeownersFile":null,"isValidLegacyIssueTemplate":false,"issueTemplateHelpUrl":"https://docs.github.com/articles/about-issue-and-pull-request-templates","issueTemplate":null,"discussionTemplate":null,"language":"Markdown","large":false,"loggedIn":false,"newDiscussionPath":"/St-Pardon/alx-files_manager/discussions/new","newIssuePath":"/St-Pardon/alx-files_manager/issues/new","planSupportInfo":{"repoIsFork":null,"repoOwnedByCurrentUser":null,"requestFullPath":"/St-Pardon/alx-files_manager/blob/main/Tasks.md","showFreeOrgGatedFeatureMessage":null,"showPlanSupportBanner":null,"upgradeDataAttributes":null,"upgradePath":null},"publishBannersInfo":{"dismissActionNoticePath":"/settings/dismiss-notice/publish_action_from_dockerfile","dismissStackNoticePath":"/settings/dismiss-notice/publish_stack_from_file","releasePath":"/St-Pardon/alx-files_manager/releases/new?marketplace=true","showPublishActionBanner":false,"showPublishStackBanner":false},"renderImageOrRaw":false,"richText":"<article class=\"markdown-body entry-content container-lg\" itemprop=\"text\"><h1 tabindex=\"-1\" dir=\"auto\"><a id=\"user-content-0x04-files-manager\" class=\"anchor\" aria-hidden=\"true\" href=\"#0x04-files-manager\"><svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a>0x04. Files manager</h1>\n<h2 tabindex=\"-1\" dir=\"auto\"><a id=\"user-content-tasks\" class=\"anchor\" aria-hidden=\"true\" href=\"#tasks\"><svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a>Tasks</h2>\n<h3 tabindex=\"-1\" dir=\"auto\"><a id=\"user-content-0-redis-utils\" class=\"anchor\" aria-hidden=\"true\" href=\"#0-redis-utils\"><svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a>0. Redis utils</h3>\n<p dir=\"auto\">Inside the folder <code>utils</code>, create a file <a href=\"/St-Pardon/alx-files_manager/blob/main/utils/redis.js\">redis.js</a> that contains the class <code>RedisClient</code>.</p>\n<p dir=\"auto\"><code>RedisClient</code> should have:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> the constructor that creates a client to Redis:\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> any error of the redis client must be displayed in the console (you should use <code>on('error')</code> of the redis client)</li>\n</ul>\n</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> a function <code>isAlive</code> that returns <code>true</code> when the connection to Redis is a success otherwise, <code>false</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> an asynchronous function <code>get</code> that takes a string key as argument and returns the Redis value stored for this key</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> an asynchronous function <code>set</code> that takes a string key, a value and a duration in second as arguments to store it in Redis (with an expiration set by the duration argument)</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> an asynchronous function <code>del</code> that takes a string key as argument and remove the value in Redis for this key</li>\n</ul>\n<p dir=\"auto\">After the class definition, create and export an instance of <code>RedisClient</code> called <code>redisClient</code>.</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"user@ubuntu:~$ cat main.js\nimport redisClient from './utils/redis';\n\n(async () =&gt; {\n    console.log(redisClient.isAlive());\n    console.log(await redisClient.get('myKey'));\n    await redisClient.set('myKey', 12, 5);\n    console.log(await redisClient.get('myKey'));\n\n    setTimeout(async () =&gt; {\n        console.log(await redisClient.get('myKey'));\n    }, 1000*10)\n})();\n\nuser@ubuntu:~$ npm run dev main.js\ntrue\nnull\n12\nnull\nuser@ubuntu:~$ \"><pre class=\"notranslate\"><code>user@ubuntu:~$ cat main.js\nimport redisClient from './utils/redis';\n\n(async () =&gt; {\n    console.log(redisClient.isAlive());\n    console.log(await redisClient.get('myKey'));\n    await redisClient.set('myKey', 12, 5);\n    console.log(await redisClient.get('myKey'));\n\n    setTimeout(async () =&gt; {\n        console.log(await redisClient.get('myKey'));\n    }, 1000*10)\n})();\n\nuser@ubuntu:~$ npm run dev main.js\ntrue\nnull\n12\nnull\nuser@ubuntu:~$ \n</code></pre></div>\n<h3 tabindex=\"-1\" dir=\"auto\"><a id=\"user-content-1-mongodb-utils\" class=\"anchor\" aria-hidden=\"true\" href=\"#1-mongodb-utils\"><svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a>1. MongoDB utils</h3>\n<p dir=\"auto\">Inside the folder <a href=\"/St-Pardon/alx-files_manager/blob/main/utils\">utils</a>, create a file <a href=\"/St-Pardon/alx-files_manager/blob/main/utils/db.js\">db.js</a> that contains the class <code>DBClient</code>.</p>\n<p dir=\"auto\"><code>DBClient</code> should have:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> the constructor that creates a client to MongoDB:\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> host: from the environment variable <code>DB_HOST</code> or default: <code>localhost</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> port: from the environment variable <code>DB_PORT</code> or default: <code>27017</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> database: from the environment variable <code>DB_DATABASE</code> or default: <code>files_manager</code></li>\n</ul>\n</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> a function <code>isAlive</code> that returns <code>true</code> when the connection to MongoDB is a success otherwise, <code>false</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> an asynchronous function <code>nbUsers</code> that returns the number of documents in the collection <code>users</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> an asynchronous function <code>nbFiles</code> that returns the number of documents in the collection <code>files</code></li>\n</ul>\n<p dir=\"auto\">After the class definition, create and export an instance of <code>DBClient</code> called <code>dbClient</code>.</p>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"user@ubuntu:~$ cat main.js\nimport dbClient from './utils/db';\n\nconst waitConnection = () =&gt; {\n    return new Promise((resolve, reject) =&gt; {\n        let i = 0;\n        const repeatFct = async () =&gt; {\n            await setTimeout(() =&gt; {\n                i += 1;\n                if (i &gt;= 10) {\n                    reject()\n                }\n                else if(!dbClient.isAlive()) {\n                    repeatFct()\n                }\n                else {\n                    resolve()\n                }\n            }, 1000);\n        };\n        repeatFct();\n    })\n};\n\n(async () =&gt; {\n    console.log(dbClient.isAlive());\n    await waitConnection();\n    console.log(dbClient.isAlive());\n    console.log(await dbClient.nbUsers());\n    console.log(await dbClient.nbFiles());\n})();\n\nuser@ubuntu:~$ npm run dev main.js\nfalse\ntrue\n4\n30\nuser@ubuntu:~$ \"><pre>user@ubuntu:<span class=\"pl-k\">~</span>$ cat main.js\nimport dbClient from <span class=\"pl-s\"><span class=\"pl-pds\">'</span>./utils/db<span class=\"pl-pds\">'</span></span><span class=\"pl-k\">;</span>\n\nconst waitConnection = () =<span class=\"pl-k\">&gt;</span> {\n    <span class=\"pl-k\">return</span> new Promise<span class=\"pl-s\"><span class=\"pl-pds\">((</span>resolve<span class=\"pl-k\">,</span> reject) <span class=\"pl-k\">=&gt;</span> {</span>\n<span class=\"pl-s\">        let i = <span class=\"pl-c1\">0</span>;</span>\n<span class=\"pl-s\">        const repeatFct = async () =&gt; {</span>\n<span class=\"pl-s\">            await setTimeout(() =&gt; {</span>\n<span class=\"pl-s\">                i += <span class=\"pl-c1\">1</span>;</span>\n<span class=\"pl-s\">                if (i &gt;= <span class=\"pl-c1\">10</span>) {</span>\n<span class=\"pl-s\">                    reject()</span>\n<span class=\"pl-s\">                }</span>\n<span class=\"pl-s\">                else if(!dbClient.isAlive(<span class=\"pl-pds\">))</span></span> {\n                    <span class=\"pl-en\">repeatFct</span>()\n                }\n                <span class=\"pl-k\">else</span> {\n                    <span class=\"pl-en\">resolve</span>()\n                }\n            }, 1000)<span class=\"pl-k\">;</span>\n        }<span class=\"pl-k\">;</span>\n        <span class=\"pl-en\">repeatFct</span>();\n    })\n}<span class=\"pl-k\">;</span>\n\n(async () =<span class=\"pl-k\">&gt;</span> {\n    <span class=\"pl-en\">console.log(dbClient.isAlive</span>());\n    await <span class=\"pl-en\">waitConnection</span>();\n    <span class=\"pl-en\">console.log(dbClient.isAlive</span>());\n    console.log(await <span class=\"pl-en\">dbClient.nbUsers</span>());\n    console.log(await <span class=\"pl-en\">dbClient.nbFiles</span>());\n<span class=\"pl-en\">})</span>();\n\nuser@ubuntu:<span class=\"pl-k\">~</span>$ npm run dev main.js\n<span class=\"pl-c1\">false</span>\n<span class=\"pl-c1\">true</span>\n4\n30\nuser@ubuntu:<span class=\"pl-k\">~</span>$ </pre></div>\n<h3 tabindex=\"-1\" dir=\"auto\"><a id=\"user-content-2-first-api\" class=\"anchor\" aria-hidden=\"true\" href=\"#2-first-api\"><svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a>2. First API</h3>\n<p dir=\"auto\">Inside <a href=\"/St-Pardon/alx-files_manager/blob/main/server.js\">server.js</a>, create the Express server:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> it should listen on the port set by the environment variable <code>PORT</code> or by default <code>5000</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> it should load all routes from the file <a href=\"/St-Pardon/alx-files_manager/blob/main/routes/index.js\">routes/index.js</a></li>\n</ul>\n<p dir=\"auto\">Inside the folder <code>routes</code>, create a file <a href=\"/St-Pardon/alx-files_manager/blob/main/routes/index.js\">index.js</a> that contains all endpoints of our API:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> <code>GET /status</code> =&gt; <code>AppController.getStatus</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> <code>GET /stats</code> =&gt; <code>AppController.getStats</code></li>\n</ul>\n<p dir=\"auto\">Inside the folder <a href=\"/St-Pardon/alx-files_manager/blob/main/controllers\">controllers</a>, create a file <a href=\"/St-Pardon/alx-files_manager/blob/main/controllers/AppController.js\">AppController.js</a> that contains the definition of the 2 endpoints:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> <code>GET /status</code> should return if Redis is alive and if the DB is alive too by using the 2 utils created previously: <code>{ \"redis\": true, \"db\": true }</code> with a status code <code>200</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> <code>GET /stats</code> should return the number of users and files in DB: <code>{ \"users\": 12, \"files\": 1231 }</code> with a status code <code>200</code>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> <code>users</code> collection must be used for counting all users</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> <code>files</code> collection must be used for counting all files</li>\n</ul>\n</li>\n</ul>\n<p dir=\"auto\"><strong>Terminal 1:</strong></p>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"user@ubuntu:~$ npm run start-server\nServer running on port 5000\n...\"><pre>user@ubuntu:<span class=\"pl-k\">~</span>$ npm run start-server\nServer running on port 5000\n...</pre></div>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"Terminal 2:\n\nuser@ubuntu:~$ curl 0.0.0.0:5000/status ; echo &quot;&quot;\n{&quot;redis&quot;:true,&quot;db&quot;:true}\nuser@ubuntu:~$ \nuser@ubuntu:~$ curl 0.0.0.0:5000/stats ; echo &quot;&quot;\n{&quot;users&quot;:4,&quot;files&quot;:30}\nuser@ubuntu:~$ \"><pre>Terminal 2:\n\nuser@ubuntu:<span class=\"pl-k\">~</span>$ curl 0.0.0.0:5000/status <span class=\"pl-k\">;</span> <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>\n{<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>redis<span class=\"pl-pds\">\"</span></span>:true,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>db<span class=\"pl-pds\">\"</span></span>:true}\nuser@ubuntu:<span class=\"pl-k\">~</span>$ \nuser@ubuntu:<span class=\"pl-k\">~</span>$ curl 0.0.0.0:5000/stats <span class=\"pl-k\">;</span> <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>\n{<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>users<span class=\"pl-pds\">\"</span></span>:4,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>files<span class=\"pl-pds\">\"</span></span>:30}\nuser@ubuntu:<span class=\"pl-k\">~</span>$ </pre></div>\n<h3 tabindex=\"-1\" dir=\"auto\"><a id=\"user-content-3-create-a-new-user\" class=\"anchor\" aria-hidden=\"true\" href=\"#3-create-a-new-user\"><svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a>3. Create a new user</h3>\n<p dir=\"auto\">Now that we have a simple API, itâ€™s time to add users to our database.</p>\n<p dir=\"auto\">In the file <a href=\"/St-Pardon/alx-files_manager/blob/main/routes/index.js\">routes/index.js</a>, add a new endpoint:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> <code>POST /users</code> =&gt; UsersController.postNew\nInside <a href=\"/St-Pardon/alx-files_manager/blob/main/controllers\">controllers</a>, add a file <a href=\"/St-Pardon/alx-files_manager/blob/main/controllers/UsersController.js\">UsersController.js</a> that contains the new endpoint:</li>\n</ul>\n<p dir=\"auto\"><code>POST /users</code> should create a new user in DB:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> To create a user, you must specify an <code>email</code> and a <code>password</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> If the <code>email</code> is missing, return an error <code>Missing email</code> with a status code 400</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> If the <code>password</code> is missing, return an error <code>Missing password</code> with a status code 400</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> If the <code>email</code> already exists in DB, return an error <code>Already exist</code> with a status code 400</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> The <code>password</code> must be stored after being hashed in <code>SHA1</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> The endpoint is returning the new user with only the <code>email</code> and the <code>id </code>(auto generated by MongoDB) with a status code 201</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> The new user must be saved in the collection <code>users</code>:\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> <code>email</code>: same as the value received</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> <code>password</code>: <code>SHA1</code> value of the value received</li>\n</ul>\n</li>\n</ul>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"user@ubuntu:~$ curl 0.0.0.0:5000/users -XPOST -H &quot;Content-Type: application/json&quot; -d '{ &quot;email&quot;: &quot;user@ubuntu.com&quot;, &quot;password&quot;: &quot;toto1234!&quot; }' ; echo &quot;&quot;\n{&quot;id&quot;:&quot;5f1e7d35c7ba06511e683b21&quot;,&quot;email&quot;:&quot;user@ubuntu.com&quot;}\nuser@ubuntu:~$ \nuser@ubuntu:~$ echo 'db.users.find()' | mongo files_manager\n{ &quot;_id&quot; : ObjectId(&quot;5f1e7d35c7ba06511e683b21&quot;), &quot;email&quot; : &quot;user@ubuntu.com&quot;, &quot;password&quot; : &quot;89cad29e3ebc1035b29b1478a8e70854f25fa2b2&quot; }\nuser@ubuntu:~$ \nuser@ubuntu:~$ \nuser@ubuntu:~$ curl 0.0.0.0:5000/users -XPOST -H &quot;Content-Type: application/json&quot; -d '{ &quot;email&quot;: &quot;user@ubuntu.com&quot;, &quot;password&quot;: &quot;toto1234!&quot; }' ; echo &quot;&quot;\n{&quot;error&quot;:&quot;Already exist&quot;}\nuser@ubuntu:~$ \nuser@ubuntu:~$ curl 0.0.0.0:5000/users -XPOST -H &quot;Content-Type: application/json&quot; -d '{ &quot;email&quot;: &quot;user@ubuntu.com&quot; }' ; echo &quot;&quot;\n{&quot;error&quot;:&quot;Missing password&quot;}\nuser@ubuntu:~$ \"><pre>user@ubuntu:<span class=\"pl-k\">~</span>$ curl 0.0.0.0:5000/users -XPOST -H <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Content-Type: application/json<span class=\"pl-pds\">\"</span></span> -d <span class=\"pl-s\"><span class=\"pl-pds\">'</span>{ \"email\": \"user@ubuntu.com\", \"password\": \"toto1234!\" }<span class=\"pl-pds\">'</span></span> <span class=\"pl-k\">;</span> <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>\n{<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>id<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e7d35c7ba06511e683b21<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>email<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>user@ubuntu.com<span class=\"pl-pds\">\"</span></span>}\nuser@ubuntu:<span class=\"pl-k\">~</span>$ \nuser@ubuntu:<span class=\"pl-k\">~</span>$ <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>db.users.find()<span class=\"pl-pds\">'</span></span> <span class=\"pl-k\">|</span> mongo files_manager\n{ <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>_id<span class=\"pl-pds\">\"</span></span> <span class=\"pl-c1\">:</span> ObjectId(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e7d35c7ba06511e683b21<span class=\"pl-pds\">\"</span></span>), <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>email<span class=\"pl-pds\">\"</span></span> <span class=\"pl-c1\">:</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>user@ubuntu.com<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>password<span class=\"pl-pds\">\"</span></span> <span class=\"pl-c1\">:</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>89cad29e3ebc1035b29b1478a8e70854f25fa2b2<span class=\"pl-pds\">\"</span></span> }\nuser@ubuntu:<span class=\"pl-k\">~</span>$ \nuser@ubuntu:<span class=\"pl-k\">~</span>$ \nuser@ubuntu:<span class=\"pl-k\">~</span>$ curl 0.0.0.0:5000/users -XPOST -H <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Content-Type: application/json<span class=\"pl-pds\">\"</span></span> -d <span class=\"pl-s\"><span class=\"pl-pds\">'</span>{ \"email\": \"user@ubuntu.com\", \"password\": \"toto1234!\" }<span class=\"pl-pds\">'</span></span> <span class=\"pl-k\">;</span> <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>\n{<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>error<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Already exist<span class=\"pl-pds\">\"</span></span>}\nuser@ubuntu:<span class=\"pl-k\">~</span>$ \nuser@ubuntu:<span class=\"pl-k\">~</span>$ curl 0.0.0.0:5000/users -XPOST -H <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Content-Type: application/json<span class=\"pl-pds\">\"</span></span> -d <span class=\"pl-s\"><span class=\"pl-pds\">'</span>{ \"email\": \"user@ubuntu.com\" }<span class=\"pl-pds\">'</span></span> <span class=\"pl-k\">;</span> <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>\n{<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>error<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Missing password<span class=\"pl-pds\">\"</span></span>}\nuser@ubuntu:<span class=\"pl-k\">~</span>$ </pre></div>\n<h3 tabindex=\"-1\" dir=\"auto\"><a id=\"user-content-4-authenticate-a-user\" class=\"anchor\" aria-hidden=\"true\" href=\"#4-authenticate-a-user\"><svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a>4. Authenticate a user</h3>\n<p dir=\"auto\">In the file <a href=\"/St-Pardon/alx-files_manager/blob/main/routes/index.js\">routes/index.js</a>, add 3 new endpoints:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> <code>GET /connect</code> =&gt; <code>AuthController.getConnect</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> <code>GET /disconnect</code> =&gt; <code>AuthController.getDisconnect</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> <code>GET /users/me</code> =&gt; <code>UserController.getMe</code></li>\n</ul>\n<p dir=\"auto\">Inside controllers, add a file <a href=\"/St-Pardon/alx-files_manager/blob/main/controllers/AuthController.js\">AuthController.js</a> that contains new endpoints:</p>\n<p dir=\"auto\"><code>GET /connect</code> should sign-in the user by generating a new authentication token:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> By using the header <code>Authorization</code> and the technique of the Basic auth (Base64 of the <code>&lt;email&gt;:&lt;password&gt;</code>), find the user associate to this email and with this password (reminder: we are storing the SHA1 of the password)</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> If no user has been found, return an error <code>Unauthorized</code> with a status code 401</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Otherwise:\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Generate a random string (using <code>uuidv4</code>) as token</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Create a key: <code>auth_&lt;token&gt;</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Use this key for storing in Redis (by using the <code>redisClient</code> create previously) the user ID for 24 hours</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Return this token: <code>{ \"token\": \"155342df-2399-41da-9e8c-458b6ac52a0c\" }</code> with a status code 200</li>\n</ul>\n</li>\n</ul>\n<p dir=\"auto\">Now, we have a way to identify a user, create a token (= avoid to store the password on any front-end) and use this token for 24h to access to the API!</p>\n<p dir=\"auto\">Every authenticated endpoints of our API will look at this token inside the header <code>X-Token</code>.</p>\n<p dir=\"auto\"><code>GET /disconnect</code> should sign-out the user based on the token:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Retrieve the user based on the token:\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> If not found, return an error <code>Unauthorized</code> with a status code 401</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Otherwise, delete the token in Redis and return nothing with a status code 204</li>\n</ul>\n</li>\n</ul>\n<p dir=\"auto\">Inside the file <a href=\"/St-Pardon/alx-files_manager/blob/main/controllers/UsersController.js\">controllers/UsersController.js</a> add a new endpoint:</p>\n<p dir=\"auto\"><code>GET /users/me</code> should retrieve the user base on the token used:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Retrieve the user based on the token:\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> If not found, return an error <code>Unauthorized</code> with a status code 401</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Otherwise, return the user object (<code>email </code>and <code>id</code> only)</li>\n</ul>\n</li>\n</ul>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"user@ubuntu:~$ curl 0.0.0.0:5000/connect -H &quot;Authorization: Basic Ym9iQGR5bGFuLmNvbTp0b3RvMTIzNCE=&quot; ; echo &quot;&quot;\n{&quot;token&quot;:&quot;031bffac-3edc-4e51-aaae-1c121317da8a&quot;}\nuser@ubuntu:~$ \nuser@ubuntu:~$ curl 0.0.0.0:5000/users/me -H &quot;X-Token: 031bffac-3edc-4e51-aaae-1c121317da8a&quot; ; echo &quot;&quot;\n{&quot;id&quot;:&quot;5f1e7cda04a394508232559d&quot;,&quot;email&quot;:&quot;user@ubuntu.com&quot;}\nuser@ubuntu:~$ \nuser@ubuntu:~$ curl 0.0.0.0:5000/disconnect -H &quot;X-Token: 031bffac-3edc-4e51-aaae-1c121317da8a&quot; ; echo &quot;&quot;\n\nuser@ubuntu:~$ curl 0.0.0.0:5000/users/me -H &quot;X-Token: 031bffac-3edc-4e51-aaae-1c121317da8a&quot; ; echo &quot;&quot;\n{&quot;error&quot;:&quot;Unauthorized&quot;}\nuser@ubuntu:~$ \"><pre>user@ubuntu:<span class=\"pl-k\">~</span>$ curl 0.0.0.0:5000/connect -H <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Authorization: Basic Ym9iQGR5bGFuLmNvbTp0b3RvMTIzNCE=<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">;</span> <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>\n{<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>token<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>031bffac-3edc-4e51-aaae-1c121317da8a<span class=\"pl-pds\">\"</span></span>}\nuser@ubuntu:<span class=\"pl-k\">~</span>$ \nuser@ubuntu:<span class=\"pl-k\">~</span>$ curl 0.0.0.0:5000/users/me -H <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>X-Token: 031bffac-3edc-4e51-aaae-1c121317da8a<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">;</span> <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>\n{<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>id<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e7cda04a394508232559d<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>email<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>user@ubuntu.com<span class=\"pl-pds\">\"</span></span>}\nuser@ubuntu:<span class=\"pl-k\">~</span>$ \nuser@ubuntu:<span class=\"pl-k\">~</span>$ curl 0.0.0.0:5000/disconnect -H <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>X-Token: 031bffac-3edc-4e51-aaae-1c121317da8a<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">;</span> <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>\n\nuser@ubuntu:<span class=\"pl-k\">~</span>$ curl 0.0.0.0:5000/users/me -H <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>X-Token: 031bffac-3edc-4e51-aaae-1c121317da8a<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">;</span> <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>\n{<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>error<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Unauthorized<span class=\"pl-pds\">\"</span></span>}\nuser@ubuntu:<span class=\"pl-k\">~</span>$ </pre></div>\n<h3 tabindex=\"-1\" dir=\"auto\"><a id=\"user-content-5-first-file\" class=\"anchor\" aria-hidden=\"true\" href=\"#5-first-file\"><svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a>5. First file</h3>\n<p dir=\"auto\">In the file <a href=\"/St-Pardon/alx-files_manager/blob/main/routes/index.js\">routes/index.js</a>, add a new endpoint:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> <code>POST /files</code> =&gt; <code>FilesController.postUpload</code></li>\n</ul>\n<p dir=\"auto\">Inside <a href=\"/St-Pardon/alx-files_manager/blob/main/controllers\">controllers</a>, add a file <a href=\"/St-Pardon/alx-files_manager/blob/main/controllers/FilesController.js\">FilesController.js</a> that contains the new endpoint:</p>\n<p dir=\"auto\"><code>POST /files</code> should create a new file in DB and in disk:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Retrieve the user based on the token:\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> If not found, return an error <code>Unauthorized</code> with a status code 401</li>\n</ul>\n</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> To create a file, you must specify:\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> <code>name</code>: as filename</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> <code>type</code>: either <code>folder</code>, <code>file</code> or <code>image</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> <code>parentId</code>: (optional) as ID of the parent (default: 0 -&gt; the root)</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> <code>isPublic</code>: (optional) as boolean to define if the file is public or not (default: <code>false</code>)</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> <code>data</code>: (only for <code>type=file|image</code>) as Base64 of the file content</li>\n</ul>\n</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> If the <code>name</code> is missing, return an error <code>Missing name</code> with a status code 400</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> If the <code>type</code> is missing or not part of the list of accepted type, return an error <code>Missing type</code> with a status code 400</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> If the <code>data</code> is missing and <code>type != folder</code>, return an error <code>Missing data</code> with a status code 400</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> If the <code>parentId</code> is set:\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> If no file is present in DB for this <code>parentId</code>, return an error <code>Parent not found</code> with a status code 400</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> If the file present in DB for this <code>parentId</code> is not of type <code>folder</code>, return an error <code>Parent is not a folder</code> with a status code 400</li>\n</ul>\n</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> The user ID should be added to the document saved in DB - as owner of a file</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> If the type is <code>folder</code>, add the new file document in the DB and return the new file with a status code 201</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Otherwise:\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> All file will be stored locally in a folder (to create automatically if not present):\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> The relative path of this folder is given by the environment variable <code>FOLDER_PATH</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> If this variable is not present or empty, use <code>/tmp/files_manager</code> as storing folder path</li>\n</ul>\n</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Create a local path in the storing folder with filename a UUID</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Store the file in clear (reminder: <code>data</code> contains the Base64 of the file) in this local path</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Add the new file document in the collection <code>files</code> with these attributes:\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> userId: ID of the owner document (owner from the authentication)</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> <code>name</code>: same as the value received</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> <code>type</code> same as the value received</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> <code>isPublic</code>: same as the value received</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> <code>parentId</code>: same as the value received - if not present: 0</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> <code>localPath</code>: for a <code>type=file|image</code>, the absolute path to the file save in local</li>\n</ul>\n</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Return the new file with a status code 201</li>\n</ul>\n</li>\n</ul>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"user@ubuntu:~$ curl 0.0.0.0:5000/connect -H &quot;Authorization: Basic Ym9iQGR5bGFuLmNvbTp0b3RvMTIzNCE=&quot; ; echo &quot;&quot;\n{&quot;token&quot;:&quot;f21fb953-16f9-46ed-8d9c-84c6450ec80f&quot;}\nuser@ubuntu:~$ \nuser@ubuntu:~$ curl -XPOST 0.0.0.0:5000/files -H &quot;X-Token: f21fb953-16f9-46ed-8d9c-84c6450ec80f&quot; -H &quot;Content-Type: application/json&quot; -d '{ &quot;name&quot;: &quot;myText.txt&quot;, &quot;type&quot;: &quot;file&quot;, &quot;data&quot;: &quot;SGVsbG8gV2Vic3RhY2shCg==&quot; }' ; echo &quot;&quot;\n{&quot;id&quot;:&quot;5f1e879ec7ba06511e683b22&quot;,&quot;userId&quot;:&quot;5f1e7cda04a394508232559d&quot;,&quot;name&quot;:&quot;myText.txt&quot;,&quot;type&quot;:&quot;file&quot;,&quot;isPublic&quot;:false,&quot;parentId&quot;:0}\nuser@ubuntu:~$\nuser@ubuntu:~$ ls /tmp/files_manager/\n2a1f4fc3-687b-491a-a3d2-5808a02942c9\nuser@ubuntu:~$\nuser@ubuntu:~$ cat /tmp/files_manager/2a1f4fc3-687b-491a-a3d2-5808a02942c9 \nHello Webstack!\nuser@ubuntu:~$\nuser@ubuntu:~$ curl -XPOST 0.0.0.0:5000/files -H &quot;X-Token: f21fb953-16f9-46ed-8d9c-84c6450ec80f&quot; -H &quot;Content-Type: application/json&quot; -d '{ &quot;name&quot;: &quot;images&quot;, &quot;type&quot;: &quot;folder&quot; }' ; echo &quot;&quot;\n{&quot;id&quot;:&quot;5f1e881cc7ba06511e683b23&quot;,&quot;userId&quot;:&quot;5f1e7cda04a394508232559d&quot;,&quot;name&quot;:&quot;images&quot;,&quot;type&quot;:&quot;folder&quot;,&quot;isPublic&quot;:false,&quot;parentId&quot;:0}\nuser@ubuntu:~$\nuser@ubuntu:~$ cat image_upload.py\nimport base64\nimport requests\nimport sys\n\nfile_path = sys.argv[1]\nfile_name = file_path.split('/')[-1]\n\nfile_encoded = None\nwith open(file_path, &quot;rb&quot;) as image_file:\n    file_encoded = base64.b64encode(image_file.read()).decode('utf-8')\n\nr_json = { 'name': file_name, 'type': 'image', 'isPublic': True, 'data': file_encoded, 'parentId': sys.argv[3] }\nr_headers = { 'X-Token': sys.argv[2] }\n\nr = requests.post(&quot;http://0.0.0.0:5000/files&quot;, json=r_json, headers=r_headers)\nprint(r.json())\n\nuser@ubuntu:~$\nuser@ubuntu:~$ python image_upload.py image.png f21fb953-16f9-46ed-8d9c-84c6450ec80f 5f1e881cc7ba06511e683b23\n{'id': '5f1e8896c7ba06511e683b25', 'userId': '5f1e7cda04a394508232559d', 'name': 'image.png', 'type': 'image', 'isPublic': True, 'parentId': '5f1e881cc7ba06511e683b23'}\nuser@ubuntu:~$\nuser@ubuntu:~$ echo 'db.files.find()' | mongo files_manager\n{ &quot;_id&quot; : ObjectId(&quot;5f1e881cc7ba06511e683b23&quot;), &quot;userId&quot; : ObjectId(&quot;5f1e7cda04a394508232559d&quot;), &quot;name&quot; : &quot;images&quot;, &quot;type&quot; : &quot;folder&quot;, &quot;parentId&quot; : &quot;0&quot; }\n{ &quot;_id&quot; : ObjectId(&quot;5f1e879ec7ba06511e683b22&quot;), &quot;userId&quot; : ObjectId(&quot;5f1e7cda04a394508232559d&quot;), &quot;name&quot; : &quot;myText.txt&quot;, &quot;type&quot; : &quot;file&quot;, &quot;parentId&quot; : &quot;0&quot;, &quot;isPublic&quot; : false, &quot;localPath&quot; : &quot;/tmp/files_manager/2a1f4fc3-687b-491a-a3d2-5808a02942c9&quot; }\n{ &quot;_id&quot; : ObjectId(&quot;5f1e8896c7ba06511e683b25&quot;), &quot;userId&quot; : ObjectId(&quot;5f1e7cda04a394508232559d&quot;), &quot;name&quot; : &quot;image.png&quot;, &quot;type&quot; : &quot;image&quot;, &quot;parentId&quot; : ObjectId(&quot;5f1e881cc7ba06511e683b23&quot;), &quot;isPublic&quot; : true, &quot;localPath&quot; : &quot;/tmp/files_manager/51997b88-5c42-42c2-901e-e7f4e71bdc47&quot; }\nuser@ubuntu:~$\nuser@ubuntu:~$ ls /tmp/files_manager/\n2a1f4fc3-687b-491a-a3d2-5808a02942c9   51997b88-5c42-42c2-901e-e7f4e71bdc47\nuser@ubuntu:~$\"><pre>user@ubuntu:<span class=\"pl-k\">~</span>$ curl 0.0.0.0:5000/connect -H <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Authorization: Basic Ym9iQGR5bGFuLmNvbTp0b3RvMTIzNCE=<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">;</span> <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>\n{<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>token<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>f21fb953-16f9-46ed-8d9c-84c6450ec80f<span class=\"pl-pds\">\"</span></span>}\nuser@ubuntu:<span class=\"pl-k\">~</span>$ \nuser@ubuntu:<span class=\"pl-k\">~</span>$ curl -XPOST 0.0.0.0:5000/files -H <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>X-Token: f21fb953-16f9-46ed-8d9c-84c6450ec80f<span class=\"pl-pds\">\"</span></span> -H <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Content-Type: application/json<span class=\"pl-pds\">\"</span></span> -d <span class=\"pl-s\"><span class=\"pl-pds\">'</span>{ \"name\": \"myText.txt\", \"type\": \"file\", \"data\": \"SGVsbG8gV2Vic3RhY2shCg==\" }<span class=\"pl-pds\">'</span></span> <span class=\"pl-k\">;</span> <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>\n{<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>id<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e879ec7ba06511e683b22<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>userId<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e7cda04a394508232559d<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>name<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>myText.txt<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>type<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>file<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>isPublic<span class=\"pl-pds\">\"</span></span>:false,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>parentId<span class=\"pl-pds\">\"</span></span>:0}\nuser@ubuntu:<span class=\"pl-k\">~</span>$\nuser@ubuntu:<span class=\"pl-k\">~</span>$ ls /tmp/files_manager/\n2a1f4fc3-687b-491a-a3d2-5808a02942c9\nuser@ubuntu:<span class=\"pl-k\">~</span>$\nuser@ubuntu:<span class=\"pl-k\">~</span>$ cat /tmp/files_manager/2a1f4fc3-687b-491a-a3d2-5808a02942c9 \nHello Webstack<span class=\"pl-k\">!</span>\nuser@ubuntu:<span class=\"pl-k\">~</span>$\nuser@ubuntu:<span class=\"pl-k\">~</span>$ curl -XPOST 0.0.0.0:5000/files -H <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>X-Token: f21fb953-16f9-46ed-8d9c-84c6450ec80f<span class=\"pl-pds\">\"</span></span> -H <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Content-Type: application/json<span class=\"pl-pds\">\"</span></span> -d <span class=\"pl-s\"><span class=\"pl-pds\">'</span>{ \"name\": \"images\", \"type\": \"folder\" }<span class=\"pl-pds\">'</span></span> <span class=\"pl-k\">;</span> <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>\n{<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>id<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e881cc7ba06511e683b23<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>userId<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e7cda04a394508232559d<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>name<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>images<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>type<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>folder<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>isPublic<span class=\"pl-pds\">\"</span></span>:false,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>parentId<span class=\"pl-pds\">\"</span></span>:0}\nuser@ubuntu:<span class=\"pl-k\">~</span>$\nuser@ubuntu:<span class=\"pl-k\">~</span>$ cat image_upload.py\nimport base64\nimport requests\nimport sys\n\nfile_path = sys.argv[1]\nfile_name = file_path.split(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>/<span class=\"pl-pds\">'</span></span>)[-1]\n\nfile_encoded = None\nwith open(file_path, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>rb<span class=\"pl-pds\">\"</span></span>) as image_file:\n    file_encoded = <span class=\"pl-en\">base64.b64encode(image_file.read</span>()).decode(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>utf-8<span class=\"pl-pds\">'</span></span>)\n\nr_json = { <span class=\"pl-s\"><span class=\"pl-pds\">'</span>name<span class=\"pl-pds\">'</span></span>: file_name, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>type<span class=\"pl-pds\">'</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">'</span>image<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>isPublic<span class=\"pl-pds\">'</span></span>: True, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>data<span class=\"pl-pds\">'</span></span>: file_encoded, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>parentId<span class=\"pl-pds\">'</span></span>: sys.argv[3] }\nr_headers = { <span class=\"pl-s\"><span class=\"pl-pds\">'</span>X-Token<span class=\"pl-pds\">'</span></span>: sys.argv[2] }\n\nr = requests.post(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>http://0.0.0.0:5000/files<span class=\"pl-pds\">\"</span></span>, json=r_json, headers=r_headers)\n<span class=\"pl-en\">print(r.json</span>())\n\nuser@ubuntu:<span class=\"pl-k\">~</span>$\nuser@ubuntu:<span class=\"pl-k\">~</span>$ python image_upload.py image.png f21fb953-16f9-46ed-8d9c-84c6450ec80f 5f1e881cc7ba06511e683b23\n{<span class=\"pl-s\"><span class=\"pl-pds\">'</span>id<span class=\"pl-pds\">'</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">'</span>5f1e8896c7ba06511e683b25<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>userId<span class=\"pl-pds\">'</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">'</span>5f1e7cda04a394508232559d<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>name<span class=\"pl-pds\">'</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">'</span>image.png<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>type<span class=\"pl-pds\">'</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">'</span>image<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>isPublic<span class=\"pl-pds\">'</span></span>: True, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>parentId<span class=\"pl-pds\">'</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">'</span>5f1e881cc7ba06511e683b23<span class=\"pl-pds\">'</span></span>}\nuser@ubuntu:<span class=\"pl-k\">~</span>$\nuser@ubuntu:<span class=\"pl-k\">~</span>$ <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>db.files.find()<span class=\"pl-pds\">'</span></span> <span class=\"pl-k\">|</span> mongo files_manager\n{ <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>_id<span class=\"pl-pds\">\"</span></span> <span class=\"pl-c1\">:</span> ObjectId(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e881cc7ba06511e683b23<span class=\"pl-pds\">\"</span></span>), <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>userId<span class=\"pl-pds\">\"</span></span> <span class=\"pl-c1\">:</span> ObjectId(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e7cda04a394508232559d<span class=\"pl-pds\">\"</span></span>), <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>name<span class=\"pl-pds\">\"</span></span> <span class=\"pl-c1\">:</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>images<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>type<span class=\"pl-pds\">\"</span></span> <span class=\"pl-c1\">:</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>folder<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>parentId<span class=\"pl-pds\">\"</span></span> <span class=\"pl-c1\">:</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>0<span class=\"pl-pds\">\"</span></span> }\n{ <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>_id<span class=\"pl-pds\">\"</span></span> <span class=\"pl-c1\">:</span> ObjectId(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e879ec7ba06511e683b22<span class=\"pl-pds\">\"</span></span>), <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>userId<span class=\"pl-pds\">\"</span></span> <span class=\"pl-c1\">:</span> ObjectId(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e7cda04a394508232559d<span class=\"pl-pds\">\"</span></span>), <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>name<span class=\"pl-pds\">\"</span></span> <span class=\"pl-c1\">:</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>myText.txt<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>type<span class=\"pl-pds\">\"</span></span> <span class=\"pl-c1\">:</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>file<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>parentId<span class=\"pl-pds\">\"</span></span> <span class=\"pl-c1\">:</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>0<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>isPublic<span class=\"pl-pds\">\"</span></span> <span class=\"pl-c1\">:</span> false, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>localPath<span class=\"pl-pds\">\"</span></span> <span class=\"pl-c1\">:</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/tmp/files_manager/2a1f4fc3-687b-491a-a3d2-5808a02942c9<span class=\"pl-pds\">\"</span></span> }\n{ <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>_id<span class=\"pl-pds\">\"</span></span> <span class=\"pl-c1\">:</span> ObjectId(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e8896c7ba06511e683b25<span class=\"pl-pds\">\"</span></span>), <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>userId<span class=\"pl-pds\">\"</span></span> <span class=\"pl-c1\">:</span> ObjectId(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e7cda04a394508232559d<span class=\"pl-pds\">\"</span></span>), <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>name<span class=\"pl-pds\">\"</span></span> <span class=\"pl-c1\">:</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>image.png<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>type<span class=\"pl-pds\">\"</span></span> <span class=\"pl-c1\">:</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>image<span class=\"pl-pds\">\"</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>parentId<span class=\"pl-pds\">\"</span></span> <span class=\"pl-c1\">:</span> ObjectId(<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e881cc7ba06511e683b23<span class=\"pl-pds\">\"</span></span>), <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>isPublic<span class=\"pl-pds\">\"</span></span> <span class=\"pl-c1\">:</span> true, <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>localPath<span class=\"pl-pds\">\"</span></span> <span class=\"pl-c1\">:</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>/tmp/files_manager/51997b88-5c42-42c2-901e-e7f4e71bdc47<span class=\"pl-pds\">\"</span></span> }\nuser@ubuntu:<span class=\"pl-k\">~</span>$\nuser@ubuntu:<span class=\"pl-k\">~</span>$ ls /tmp/files_manager/\n2a1f4fc3-687b-491a-a3d2-5808a02942c9   51997b88-5c42-42c2-901e-e7f4e71bdc47\nuser@ubuntu:<span class=\"pl-k\">~</span>$</pre></div>\n<h3 tabindex=\"-1\" dir=\"auto\"><a id=\"user-content-6-get-and-list-file\" class=\"anchor\" aria-hidden=\"true\" href=\"#6-get-and-list-file\"><svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a>6. Get and list file</h3>\n<p dir=\"auto\">In the file <a href=\"/St-Pardon/alx-files_manager/blob/main/routes/index.js\">routes/index.js</a>, add 2 new endpoints:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> <code>GET /files/:id</code> =&gt; <code>FilesController.getShow</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> <code>GET /files</code> =&gt; <code>FilesController.getIndex</code></li>\n</ul>\n<p dir=\"auto\">In the file <a href=\"/St-Pardon/alx-files_manager/blob/main/controllers/FilesController.js\">controllers/FilesController.js</a>, add the 2 new endpoints:</p>\n<p dir=\"auto\"><code>GET /files/:id</code> should retrieve the file document based on the ID:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Retrieve the user based on the token:\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> If not found, return an error <code>Unauthorized</code> with a status code 401</li>\n</ul>\n</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> If no file document is linked to the user and the ID passed as parameter, return an error Not found with a status code 404</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Otherwise, return the file document</li>\n</ul>\n<p dir=\"auto\"><code>GET /files</code> should retrieve all users file documents for a specific <code>parentId</code> and with pagination:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Retrieve the user based on the token:\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> If not found, return an error <code>Unauthorized</code> with a status code 401</li>\n</ul>\n</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Based on the query parameters <code>parentId</code> and <code>page</code>, return the list of file document\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> <code>parentId</code>:\nNo validation of parentId needed - if the parentId is not linked to any user folder, returns an empty list\nBy default, parentId is equal to 0 = the root</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Pagination:\nEach page should be 20 items max\n<code>page</code> query parameter starts at 0 for the first page. If equals to 1, it means itâ€™s the second page (form the 20th to the 40th), etcâ€¦\nPagination can be done directly by the <code>aggregate</code> of MongoDB</li>\n</ul>\n</li>\n</ul>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"bob@dylan:~$ curl 0.0.0.0:5000/connect -H &quot;Authorization: Basic Ym9iQGR5bGFuLmNvbTp0b3RvMTIzNCE=&quot; ; echo &quot;&quot;\n{&quot;token&quot;:&quot;f21fb953-16f9-46ed-8d9c-84c6450ec80f&quot;}\nbob@dylan:~$ \nbob@dylan:~$ curl -XGET 0.0.0.0:5000/files -H &quot;X-Token: f21fb953-16f9-46ed-8d9c-84c6450ec80f&quot; ; echo &quot;&quot;\n[{&quot;id&quot;:&quot;5f1e879ec7ba06511e683b22&quot;,&quot;userId&quot;:&quot;5f1e7cda04a394508232559d&quot;,&quot;name&quot;:&quot;myText.txt&quot;,&quot;type&quot;:&quot;file&quot;,&quot;isPublic&quot;:false,&quot;parentId&quot;:0},{&quot;id&quot;:&quot;5f1e881cc7ba06511e683b23&quot;,&quot;userId&quot;:&quot;5f1e7cda04a394508232559d&quot;,&quot;name&quot;:&quot;images&quot;,&quot;type&quot;:&quot;folder&quot;,&quot;isPublic&quot;:false,&quot;parentId&quot;:0},{&quot;id&quot;:&quot;5f1e8896c7ba06511e683b25&quot;,&quot;userId&quot;:&quot;5f1e7cda04a394508232559d&quot;,&quot;name&quot;:&quot;image.png&quot;,&quot;type&quot;:&quot;image&quot;,&quot;isPublic&quot;:true,&quot;parentId&quot;:&quot;5f1e881cc7ba06511e683b23&quot;}]\nbob@dylan:~$\nbob@dylan:~$ curl -XGET 0.0.0.0:5000/files?parentId=5f1e881cc7ba06511e683b23 -H &quot;X-Token: f21fb953-16f9-46ed-8d9c-84c6450ec80f&quot; ; echo &quot;&quot;\n[{&quot;id&quot;:&quot;5f1e8896c7ba06511e683b25&quot;,&quot;userId&quot;:&quot;5f1e7cda04a394508232559d&quot;,&quot;name&quot;:&quot;image.png&quot;,&quot;type&quot;:&quot;image&quot;,&quot;isPublic&quot;:true,&quot;parentId&quot;:&quot;5f1e881cc7ba06511e683b23&quot;}]\nbob@dylan:~$\nbob@dylan:~$ curl -XGET 0.0.0.0:5000/files/5f1e8896c7ba06511e683b25 -H &quot;X-Token: f21fb953-16f9-46ed-8d9c-84c6450ec80f&quot; ; echo &quot;&quot;\n{&quot;id&quot;:&quot;5f1e8896c7ba06511e683b25&quot;,&quot;userId&quot;:&quot;5f1e7cda04a394508232559d&quot;,&quot;name&quot;:&quot;image.png&quot;,&quot;type&quot;:&quot;image&quot;,&quot;isPublic&quot;:true,&quot;parentId&quot;:&quot;5f1e881cc7ba06511e683b23&quot;}\nbob@dylan:~$\"><pre>bob@dylan:<span class=\"pl-k\">~</span>$ curl 0.0.0.0:5000/connect -H <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Authorization: Basic Ym9iQGR5bGFuLmNvbTp0b3RvMTIzNCE=<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">;</span> <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>\n{<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>token<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>f21fb953-16f9-46ed-8d9c-84c6450ec80f<span class=\"pl-pds\">\"</span></span>}\nbob@dylan:<span class=\"pl-k\">~</span>$ \nbob@dylan:<span class=\"pl-k\">~</span>$ curl -XGET 0.0.0.0:5000/files -H <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>X-Token: f21fb953-16f9-46ed-8d9c-84c6450ec80f<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">;</span> <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>\n[{<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>id<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e879ec7ba06511e683b22<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>userId<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e7cda04a394508232559d<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>name<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>myText.txt<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>type<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>file<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>isPublic<span class=\"pl-pds\">\"</span></span>:false,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>parentId<span class=\"pl-pds\">\"</span></span>:0},{<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>id<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e881cc7ba06511e683b23<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>userId<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e7cda04a394508232559d<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>name<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>images<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>type<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>folder<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>isPublic<span class=\"pl-pds\">\"</span></span>:false,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>parentId<span class=\"pl-pds\">\"</span></span>:0},{<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>id<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e8896c7ba06511e683b25<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>userId<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e7cda04a394508232559d<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>name<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>image.png<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>type<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>image<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>isPublic<span class=\"pl-pds\">\"</span></span>:true,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>parentId<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e881cc7ba06511e683b23<span class=\"pl-pds\">\"</span></span>}]\nbob@dylan:<span class=\"pl-k\">~</span>$\nbob@dylan:<span class=\"pl-k\">~</span>$ curl -XGET 0.0.0.0:5000/files<span class=\"pl-k\">?</span>parentId=5f1e881cc7ba06511e683b23 -H <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>X-Token: f21fb953-16f9-46ed-8d9c-84c6450ec80f<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">;</span> <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>\n[{<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>id<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e8896c7ba06511e683b25<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>userId<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e7cda04a394508232559d<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>name<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>image.png<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>type<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>image<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>isPublic<span class=\"pl-pds\">\"</span></span>:true,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>parentId<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e881cc7ba06511e683b23<span class=\"pl-pds\">\"</span></span>}]\nbob@dylan:<span class=\"pl-k\">~</span>$\nbob@dylan:<span class=\"pl-k\">~</span>$ curl -XGET 0.0.0.0:5000/files/5f1e8896c7ba06511e683b25 -H <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>X-Token: f21fb953-16f9-46ed-8d9c-84c6450ec80f<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">;</span> <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>\n{<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>id<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e8896c7ba06511e683b25<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>userId<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e7cda04a394508232559d<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>name<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>image.png<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>type<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>image<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>isPublic<span class=\"pl-pds\">\"</span></span>:true,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>parentId<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e881cc7ba06511e683b23<span class=\"pl-pds\">\"</span></span>}\nbob@dylan:<span class=\"pl-k\">~</span>$</pre></div>\n<h3 tabindex=\"-1\" dir=\"auto\"><a id=\"user-content-7-file-publishunpublish\" class=\"anchor\" aria-hidden=\"true\" href=\"#7-file-publishunpublish\"><svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a>7. File publish/unpublish</h3>\n<p dir=\"auto\">In the file <a href=\"/St-Pardon/alx-files_manager/blob/main/routes/index.js\">routes/index.js</a>, add 2 new endpoints:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> <code>PUT /files/:id/publish</code> =&gt; <code>FilesController.putPublish</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> <code>PUT /files/:id/publish</code> =&gt; <code>FilesController.putUnpublish</code></li>\n</ul>\n<p dir=\"auto\">In the file controllers/FilesController.js, add the 2 new endpoints:</p>\n<p dir=\"auto\"><code>PUT /files/:id/publish</code> should set <code>isPublic</code> to <code>true</code> on the file document based on the ID:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Retrieve the user based on the token:\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> If not found, return an error <code>Unauthorized</code> with a status code 401</li>\n</ul>\n</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> If no file document is linked to the user and the ID passed as parameter, return an error Not found with a status code 404</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Otherwise:\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Update the value of <code>isPublic</code> to <code>true</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> And return the file document with a status code 200</li>\n</ul>\n</li>\n</ul>\n<p dir=\"auto\"><code>PUT /files/:id/unpublish</code> should set isPublic to false on the file document based on the ID:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Retrieve the user based on the token:\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> If not found, return an error <code>Unauthorized</code> with a status code 401</li>\n</ul>\n</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> If no file document is linked to the user and the ID passed as parameter, return an error Not found with a status code 404</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Otherwise:\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Update the value of <code>isPublic</code> to <code>false</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> And return the file document with a status code 200</li>\n</ul>\n</li>\n</ul>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"bob@dylan:~$ curl 0.0.0.0:5000/connect -H &quot;Authorization: Basic Ym9iQGR5bGFuLmNvbTp0b3RvMTIzNCE=&quot; ; echo &quot;&quot;\n{&quot;token&quot;:&quot;f21fb953-16f9-46ed-8d9c-84c6450ec80f&quot;}\nbob@dylan:~$ \nbob@dylan:~$ curl -XGET 0.0.0.0:5000/files/5f1e8896c7ba06511e683b25 -H &quot;X-Token: f21fb953-16f9-46ed-8d9c-84c6450ec80f&quot; ; echo &quot;&quot;\n{&quot;id&quot;:&quot;5f1e8896c7ba06511e683b25&quot;,&quot;userId&quot;:&quot;5f1e7cda04a394508232559d&quot;,&quot;name&quot;:&quot;image.png&quot;,&quot;type&quot;:&quot;image&quot;,&quot;isPublic&quot;:false,&quot;parentId&quot;:&quot;5f1e881cc7ba06511e683b23&quot;}\nbob@dylan:~$\nbob@dylan:~$ curl -XPUT 0.0.0.0:5000/files/5f1e8896c7ba06511e683b25/publish -H &quot;X-Token: f21fb953-16f9-46ed-8d9c-84c6450ec80f&quot; ; echo &quot;&quot;\n{&quot;id&quot;:&quot;5f1e8896c7ba06511e683b25&quot;,&quot;userId&quot;:&quot;5f1e7cda04a394508232559d&quot;,&quot;name&quot;:&quot;image.png&quot;,&quot;type&quot;:&quot;image&quot;,&quot;isPublic&quot;:true,&quot;parentId&quot;:&quot;5f1e881cc7ba06511e683b23&quot;}\nbob@dylan:~$ \nbob@dylan:~$ curl -XPUT 0.0.0.0:5000/files/5f1e8896c7ba06511e683b25/unpublish -H &quot;X-Token: f21fb953-16f9-46ed-8d9c-84c6450ec80f&quot; ; echo &quot;&quot;\n{&quot;id&quot;:&quot;5f1e8896c7ba06511e683b25&quot;,&quot;userId&quot;:&quot;5f1e7cda04a394508232559d&quot;,&quot;name&quot;:&quot;image.png&quot;,&quot;type&quot;:&quot;image&quot;,&quot;isPublic&quot;:false,&quot;parentId&quot;:&quot;5f1e881cc7ba06511e683b23&quot;}\nbob@dylan:~$ \"><pre>bob@dylan:<span class=\"pl-k\">~</span>$ curl 0.0.0.0:5000/connect -H <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Authorization: Basic Ym9iQGR5bGFuLmNvbTp0b3RvMTIzNCE=<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">;</span> <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>\n{<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>token<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>f21fb953-16f9-46ed-8d9c-84c6450ec80f<span class=\"pl-pds\">\"</span></span>}\nbob@dylan:<span class=\"pl-k\">~</span>$ \nbob@dylan:<span class=\"pl-k\">~</span>$ curl -XGET 0.0.0.0:5000/files/5f1e8896c7ba06511e683b25 -H <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>X-Token: f21fb953-16f9-46ed-8d9c-84c6450ec80f<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">;</span> <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>\n{<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>id<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e8896c7ba06511e683b25<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>userId<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e7cda04a394508232559d<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>name<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>image.png<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>type<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>image<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>isPublic<span class=\"pl-pds\">\"</span></span>:false,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>parentId<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e881cc7ba06511e683b23<span class=\"pl-pds\">\"</span></span>}\nbob@dylan:<span class=\"pl-k\">~</span>$\nbob@dylan:<span class=\"pl-k\">~</span>$ curl -XPUT 0.0.0.0:5000/files/5f1e8896c7ba06511e683b25/publish -H <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>X-Token: f21fb953-16f9-46ed-8d9c-84c6450ec80f<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">;</span> <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>\n{<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>id<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e8896c7ba06511e683b25<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>userId<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e7cda04a394508232559d<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>name<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>image.png<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>type<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>image<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>isPublic<span class=\"pl-pds\">\"</span></span>:true,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>parentId<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e881cc7ba06511e683b23<span class=\"pl-pds\">\"</span></span>}\nbob@dylan:<span class=\"pl-k\">~</span>$ \nbob@dylan:<span class=\"pl-k\">~</span>$ curl -XPUT 0.0.0.0:5000/files/5f1e8896c7ba06511e683b25/unpublish -H <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>X-Token: f21fb953-16f9-46ed-8d9c-84c6450ec80f<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">;</span> <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>\n{<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>id<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e8896c7ba06511e683b25<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>userId<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e7cda04a394508232559d<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>name<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>image.png<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>type<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>image<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>isPublic<span class=\"pl-pds\">\"</span></span>:false,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>parentId<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e881cc7ba06511e683b23<span class=\"pl-pds\">\"</span></span>}\nbob@dylan:<span class=\"pl-k\">~</span>$ </pre></div>\n<h3 tabindex=\"-1\" dir=\"auto\"><a id=\"user-content-8-file-data\" class=\"anchor\" aria-hidden=\"true\" href=\"#8-file-data\"><svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a>8. File data</h3>\n<p dir=\"auto\">In the file <a href=\"/St-Pardon/alx-files_manager/blob/main/routes/index.js\">routes/index.js</a>, add one new endpoint:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> <code>GET /files/:id/data</code> =&gt; <code>FilesController.getFile</code></li>\n</ul>\n<p dir=\"auto\">In the file [controllers/FilesController.js](./controllers/FilesController.js   - [x] ), add the new endpoint:</p>\n<p dir=\"auto\"><code>GET /files/:id/data</code> should return the content of the file document based on the ID:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> If no file document is linked to the ID passed as parameter, return an error <code>Not found</code> with a status code 404</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> If the file document (folder or file) is not public (<code>isPublic: false</code>) and no user authenticate or not the owner of the file, return an error <code>Not found</code> with a status code 404</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> If the type of the file document is folder, return an error <code>A folder doesn't have content</code> with a status code 400</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> If the file is not locally present, return an error <code>Not found</code> with a status code 404</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Otherwise:\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> By using the module <code>mime-types</code>, get the MIME-type based on the name of the file</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Return the content of the file with the correct MIME-type</li>\n</ul>\n</li>\n</ul>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"bob@dylan:~$ curl 0.0.0.0:5000/connect -H &quot;Authorization: Basic Ym9iQGR5bGFuLmNvbTp0b3RvMTIzNCE=&quot; ; echo &quot;&quot;\n{&quot;token&quot;:&quot;f21fb953-16f9-46ed-8d9c-84c6450ec80f&quot;}\nbob@dylan:~$ \nbob@dylan:~$ curl -XPUT 0.0.0.0:5000/files/5f1e879ec7ba06511e683b22/unpublish -H &quot;X-Token: f21fb953-16f9-46ed-8d9c-84c6450ec80f&quot; ; echo &quot;&quot;\n{&quot;id&quot;:&quot;5f1e879ec7ba06511e683b22&quot;,&quot;userId&quot;:&quot;5f1e7cda04a394508232559d&quot;,&quot;name&quot;:&quot;myText.txt&quot;,&quot;type&quot;:&quot;file&quot;,&quot;isPublic&quot;:false,&quot;parentId&quot;:0}\nbob@dylan:~$ \nbob@dylan:~$ curl -XGET 0.0.0.0:5000/files/5f1e879ec7ba06511e683b22/data -H &quot;X-Token: f21fb953-16f9-46ed-8d9c-84c6450ec80f&quot; ; echo &quot;&quot;\nHello Webstack!\n\nbob@dylan:~$ curl -XGET 0.0.0.0:5000/files/5f1e879ec7ba06511e683b22/data ; echo &quot;&quot;\n{&quot;error&quot;:&quot;Not found&quot;}\nbob@dylan:~$ \nbob@dylan:~$ curl -XPUT 0.0.0.0:5000/files/5f1e879ec7ba06511e683b22/publish -H &quot;X-Token: f21fb953-16f9-46ed-8d9c-84c6450ec80f&quot; ; echo &quot;&quot;\n{&quot;id&quot;:&quot;5f1e879ec7ba06511e683b22&quot;,&quot;userId&quot;:&quot;5f1e7cda04a394508232559d&quot;,&quot;name&quot;:&quot;myText.txt&quot;,&quot;type&quot;:&quot;file&quot;,&quot;isPublic&quot;:true,&quot;parentId&quot;:0}\nbob@dylan:~$ \nbob@dylan:~$ curl -XGET 0.0.0.0:5000/files/5f1e879ec7ba06511e683b22/data ; echo &quot;&quot;\nHello Webstack!\n\nbob@dylan:~$\"><pre>bob@dylan:<span class=\"pl-k\">~</span>$ curl 0.0.0.0:5000/connect -H <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Authorization: Basic Ym9iQGR5bGFuLmNvbTp0b3RvMTIzNCE=<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">;</span> <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>\n{<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>token<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>f21fb953-16f9-46ed-8d9c-84c6450ec80f<span class=\"pl-pds\">\"</span></span>}\nbob@dylan:<span class=\"pl-k\">~</span>$ \nbob@dylan:<span class=\"pl-k\">~</span>$ curl -XPUT 0.0.0.0:5000/files/5f1e879ec7ba06511e683b22/unpublish -H <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>X-Token: f21fb953-16f9-46ed-8d9c-84c6450ec80f<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">;</span> <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>\n{<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>id<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e879ec7ba06511e683b22<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>userId<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e7cda04a394508232559d<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>name<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>myText.txt<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>type<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>file<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>isPublic<span class=\"pl-pds\">\"</span></span>:false,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>parentId<span class=\"pl-pds\">\"</span></span>:0}\nbob@dylan:<span class=\"pl-k\">~</span>$ \nbob@dylan:<span class=\"pl-k\">~</span>$ curl -XGET 0.0.0.0:5000/files/5f1e879ec7ba06511e683b22/data -H <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>X-Token: f21fb953-16f9-46ed-8d9c-84c6450ec80f<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">;</span> <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>\nHello Webstack<span class=\"pl-k\">!</span>\n\nbob@dylan:<span class=\"pl-k\">~</span>$ curl -XGET 0.0.0.0:5000/files/5f1e879ec7ba06511e683b22/data <span class=\"pl-k\">;</span> <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>\n{<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>error<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Not found<span class=\"pl-pds\">\"</span></span>}\nbob@dylan:<span class=\"pl-k\">~</span>$ \nbob@dylan:<span class=\"pl-k\">~</span>$ curl -XPUT 0.0.0.0:5000/files/5f1e879ec7ba06511e683b22/publish -H <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>X-Token: f21fb953-16f9-46ed-8d9c-84c6450ec80f<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">;</span> <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>\n{<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>id<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e879ec7ba06511e683b22<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>userId<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>5f1e7cda04a394508232559d<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>name<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>myText.txt<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>type<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>file<span class=\"pl-pds\">\"</span></span>,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>isPublic<span class=\"pl-pds\">\"</span></span>:true,<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>parentId<span class=\"pl-pds\">\"</span></span>:0}\nbob@dylan:<span class=\"pl-k\">~</span>$ \nbob@dylan:<span class=\"pl-k\">~</span>$ curl -XGET 0.0.0.0:5000/files/5f1e879ec7ba06511e683b22/data <span class=\"pl-k\">;</span> <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>\nHello Webstack<span class=\"pl-k\">!</span>\n\nbob@dylan:<span class=\"pl-k\">~</span>$</pre></div>\n<h3 tabindex=\"-1\" dir=\"auto\"><a id=\"user-content-9-image-thumbnails\" class=\"anchor\" aria-hidden=\"true\" href=\"#9-image-thumbnails\"><svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a>9. Image Thumbnails</h3>\n<p dir=\"auto\">Update the endpoint <code>POST /files</code> endpoint to start a background processing for generating thumbnails for a file of type <code>image</code>:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Create a <code>Bull</code> queue <code>fileQueue</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> When a new image is stored (in local and in DB), add a job to this queue with the <code>userId</code> and <code>fileId</code></li>\n</ul>\n<p dir=\"auto\">Create a file <a href=\"/St-Pardon/alx-files_manager/blob/main/worker.js\">worker.js</a>:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> By using the module <code>Bull</code>, create a queue <code>fileQueue</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Process this queue:\nIf <code>fileId</code> is not present in the job, raise an error <code>Missing fileId</code>\nIf <code>userId</code> is not present in the job, raise an error <code>Missing userId</code>\nIf no document is found in DB based on the <code>fileId</code> and <code>userId</code>, raise an error File not found\nBy using the module <code>image-thumbnail</code>, generate 3 thumbnails with width = 500, 250 and 100 - store each result on the same location of the original file by appending <code>_&lt;width size&gt;</code></li>\n</ul>\n<p dir=\"auto\">Update the endpoint <code>GET /files/:id/data</code> to accept a query parameter <code>size</code>:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> <code>size</code> can be <code>500</code>, <code>250</code> or <code>100</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Based on <code>size</code>, return the correct local file</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> If the local file doesnâ€™t exist, return an error <code>Not found</code> with a status code 404</li>\n</ul>\n<p dir=\"auto\">Terminal 3: (start the worker)</p>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"bob@dylan:~$ npm run start-worker\n...\"><pre>bob@dylan:<span class=\"pl-k\">~</span>$ npm run start-worker\n...</pre></div>\n<p dir=\"auto\">Terminal 2:</p>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\nbob@dylan:~$ curl 0.0.0.0:5000/connect -H &quot;Authorization: Basic Ym9iQGR5bGFuLmNvbTp0b3RvMTIzNCE=&quot; ; echo &quot;&quot;\n{&quot;token&quot;:&quot;f21fb953-16f9-46ed-8d9c-84c6450ec80f&quot;}\nbob@dylan:~$ \nbob@dylan:~$ python image_upload.py image.png f21fb953-16f9-46ed-8d9c-84c6450ec80f 5f1e881cc7ba06511e683b23\n{'id': '5f1e8896c7ba06511e683b25', 'userId': '5f1e7cda04a394508232559d', 'name': 'image.png', 'type': 'image', 'isPublic': True, 'parentId': '5f1e881cc7ba06511e683b23'}\nbob@dylan:~$ ls /tmp/files_manager/\n2a1f4fc3-687b-491a-a3d2-5808a02942c9   51997b88-5c42-42c2-901e-e7f4e71bdc47   6dc53397-8491-4b7c-8273-f748b1a031cb   6dc53397-8491-4b7c-8273-f748b1a031cb_100   6dc53397-8491-4b7c-8273-f748b1a031cb_250    6dc53397-8491-4b7c-8273-f748b1a031cb_500\nbob@dylan:~$ \nbob@dylan:~$ curl -XGET 0.0.0.0:5000/files/5f1e8896c7ba06511e683b25/data -so new_image.png ; file new_image.png\nnew_image.png: PNG image data, 471 x 512, 8-bit/color RGBA, non-interlaced\nbob@dylan:~$ \nbob@dylan:~$ curl -XGET 0.0.0.0:5000/files/5f1e8896c7ba06511e683b25/data?size=100 -so new_image.png ; file new_image.png\nnew_image.png: PNG image data, 100 x 109, 8-bit/color RGBA, non-interlaced\nbob@dylan:~$ \nbob@dylan:~$ curl -XGET 0.0.0.0:5000/files/5f1e8896c7ba06511e683b25/data?size=250 -so new_image.png ; file new_image.png\nnew_image.png: PNG image data, 250 x 272, 8-bit/color RGBA, non-interlaced\nbob@dylan:~$\"><pre>bob@dylan:<span class=\"pl-k\">~</span>$ curl 0.0.0.0:5000/connect -H <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Authorization: Basic Ym9iQGR5bGFuLmNvbTp0b3RvMTIzNCE=<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">;</span> <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-pds\">\"</span></span>\n{<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>token<span class=\"pl-pds\">\"</span></span>:<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>f21fb953-16f9-46ed-8d9c-84c6450ec80f<span class=\"pl-pds\">\"</span></span>}\nbob@dylan:<span class=\"pl-k\">~</span>$ \nbob@dylan:<span class=\"pl-k\">~</span>$ python image_upload.py image.png f21fb953-16f9-46ed-8d9c-84c6450ec80f 5f1e881cc7ba06511e683b23\n{<span class=\"pl-s\"><span class=\"pl-pds\">'</span>id<span class=\"pl-pds\">'</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">'</span>5f1e8896c7ba06511e683b25<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>userId<span class=\"pl-pds\">'</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">'</span>5f1e7cda04a394508232559d<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>name<span class=\"pl-pds\">'</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">'</span>image.png<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>type<span class=\"pl-pds\">'</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">'</span>image<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>isPublic<span class=\"pl-pds\">'</span></span>: True, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>parentId<span class=\"pl-pds\">'</span></span>: <span class=\"pl-s\"><span class=\"pl-pds\">'</span>5f1e881cc7ba06511e683b23<span class=\"pl-pds\">'</span></span>}\nbob@dylan:<span class=\"pl-k\">~</span>$ ls /tmp/files_manager/\n2a1f4fc3-687b-491a-a3d2-5808a02942c9   51997b88-5c42-42c2-901e-e7f4e71bdc47   6dc53397-8491-4b7c-8273-f748b1a031cb   6dc53397-8491-4b7c-8273-f748b1a031cb_100   6dc53397-8491-4b7c-8273-f748b1a031cb_250    6dc53397-8491-4b7c-8273-f748b1a031cb_500\nbob@dylan:<span class=\"pl-k\">~</span>$ \nbob@dylan:<span class=\"pl-k\">~</span>$ curl -XGET 0.0.0.0:5000/files/5f1e8896c7ba06511e683b25/data -so new_image.png <span class=\"pl-k\">;</span> file new_image.png\nnew_image.png: PNG image data, 471 x 512, 8-bit/color RGBA, non-interlaced\nbob@dylan:<span class=\"pl-k\">~</span>$ \nbob@dylan:<span class=\"pl-k\">~</span>$ curl -XGET 0.0.0.0:5000/files/5f1e8896c7ba06511e683b25/data<span class=\"pl-k\">?</span>size=100 -so new_image.png <span class=\"pl-k\">;</span> file new_image.png\nnew_image.png: PNG image data, 100 x 109, 8-bit/color RGBA, non-interlaced\nbob@dylan:<span class=\"pl-k\">~</span>$ \nbob@dylan:<span class=\"pl-k\">~</span>$ curl -XGET 0.0.0.0:5000/files/5f1e8896c7ba06511e683b25/data<span class=\"pl-k\">?</span>size=250 -so new_image.png <span class=\"pl-k\">;</span> file new_image.png\nnew_image.png: PNG image data, 250 x 272, 8-bit/color RGBA, non-interlaced\nbob@dylan:<span class=\"pl-k\">~</span>$</pre></div>\n<h3 tabindex=\"-1\" dir=\"auto\"><a id=\"user-content-10-tests\" class=\"anchor\" aria-hidden=\"true\" href=\"#10-tests\"><svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a>10. Tests!</h3>\n<p dir=\"auto\">Of course, a strong and stable project can not be good without tests.</p>\n<p dir=\"auto\">Create tests for <code>redisClient</code> and <code>dbClient</code>.</p>\n<p dir=\"auto\">Create tests for each endpoints:</p>\n<p dir=\"auto\"><code>GET /status</code>\n<code>GET /stats</code>\n<code>POST /users</code>\n<code>GET /connect</code>\n<code>GET /disconnect</code>\n<code>GET /users/me</code>\n<code>POST /files</code>\n<code>GET /files/:id</code>\n<code>GET /files</code> (donâ€™t forget the pagination)\n<code>PUT /files/:id/publish</code>\n<code>PUT /files/:id/unpublish</code>\n<code>GET /files/:id/data</code></p>\n<h3 tabindex=\"-1\" dir=\"auto\"><a id=\"user-content-11-new-user---welcome-email\" class=\"anchor\" aria-hidden=\"true\" href=\"#11-new-user---welcome-email\"><svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a>11. New user - welcome email</h3>\n<p dir=\"auto\">Update the endpoint <code>POST /users</code> endpoint to start a background processing for sending a â€œWelcome emailâ€ to the user:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\">\n<p dir=\"auto\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Create a <code>Bull</code> queue <code>userQueue</code></p>\n</li>\n<li class=\"task-list-item\">\n<p dir=\"auto\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> When a new user is stored (in DB), add a job to this queue with the userId\nUpdate the file worker.js:</p>\n</li>\n<li class=\"task-list-item\">\n<p dir=\"auto\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> By using the module <code>Bull</code>, create a queue <code>userQueue</code></p>\n</li>\n<li class=\"task-list-item\">\n<p dir=\"auto\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Process this queue:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> If <code>userId</code> is not present in the job, raise an error <code>Missing userId</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> If no document is found in DB based on the <code>userId</code>, raise an error <code>User not found</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Print in the console <code>Welcome &lt;email&gt;!</code></li>\n</ul>\n</li>\n</ul>\n<p dir=\"auto\">In real life, you can use a third party service like Mailgun to send real email. These API are slow, (sending via SMTP is worst!) and sending emails via a background job is important to optimize API endpoint.</p>\n</article>","renderedFileInfo":null,"tabSize":8,"topBannersInfo":{"overridingGlobalFundingFile":false,"globalPreferredFundingPath":null,"repoOwner":"St-Pardon","repoName":"alx-files_manager","showInvalidCitationWarning":false,"citationHelpUrl":"https://docs.github.com/en/github/creating-cloning-and-archiving-repositories/creating-a-repository-on-github/about-citation-files","showDependabotConfigurationBanner":false,"actionsOnboardingTip":null},"truncated":false,"viewable":true,"workflowRedirectUrl":null,"symbols":{"timedOut":false,"notAnalyzed":true,"symbols":[]}},"copilotUserAccess":null,"csrf_tokens":{"/St-Pardon/alx-files_manager/branches":{"post":"NQTFB6ySGxBQR7cXkGqSrDFxAVfbzJD7KX-cWSkYnoPsj1wA18Sw9wuqGRBIi-Ub2e2WKCDQFgKmWKfFJcqlkw"}}},"title":"alx-files_manager/Tasks.md at main Â· St-Pardon/alx-files_manager","locale":"en"}